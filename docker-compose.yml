services:
  db:
    image: mysql:8.0
    container_name: actionary_db
    restart: no
    ports:
      - "3333:3306"
    environment:
      MYSQL_DATABASE: actionary_db
      MYSQL_USER: ${MYSQL_USER}
      MYSQL_ROOT_PASSWORD: ${MYSQL_ROOT_PASSWORD}
      MYSQL_PASSWORD: ${MYSQL_PASSWORD}
      TZ: "Asia/Seoul"

  janus-gateway:
    image: "canyan/janus-gateway:latest"
    platform: linux/amd64
    container_name: actionary_janus_gateway
    command: [ "/usr/local/bin/janus", "-F", "/usr/local/etc/janus" ]
    ports:
      - "8088:8088"
      - "8089:8089"
      - "8889:8889"
      - "8000:8000"
      - "7088:7088"
      - "7089:7089"
    volumes:
      - "./janus/janus.jcfg:/usr/local/etc/janus/janus.jcfg"
      - "./janus/janus.transport.http.jcfg:/usr/local/etc/janus/janus.transport.http.jcfg"
    environment:
      JANUS_ADMIN_SECRET: ${JANUS_ADMIN_SECRET}
    restart: always

  redis:
    image: redis:7.2-alpine
    container_name: actionary_redis
    ports:
      - "6377:6379"
    restart: always
